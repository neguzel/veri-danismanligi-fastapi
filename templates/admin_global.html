{% extends "base.html" %}
{% block title %}Admin Paneli â€“ Veri DanÄ±ÅŸmanlÄ±ÄŸÄ±{% endblock %}

{% block page_title %}Admin Paneli{% endblock %}
{% block page_subtitle %}
YÃ¼klenen tÃ¼m veri setlerini ve mÃ¼ÅŸteri iletiÅŸim bilgilerini yÃ¶netin.
{% endblock %}

{% block content %}

<!-- Ãœst KPI'lar -->
<div class="vd-section vd-section-kpi">
  <div class="vd-kpi-row">
    <div class="vd-card vd-card-kpi vd-card-accent">
      <div class="vd-card-header">
        <div class="vd-card-icon">ğŸ“¥</div>
        <h3>Toplam YÃ¼kleme</h3>
      </div>
      <div class="vd-card-body">
        <div class="vd-kpi-value-lg">{{ total_uploads }}</div>
        <div class="vd-kpi-caption">Sistem genelinde yapÄ±lan tÃ¼m veri yÃ¼klemeleri.</div>
      </div>
    </div>

    <div class="vd-card vd-card-kpi">
      <div class="vd-card-header">
        <div class="vd-card-icon">ğŸ‘¤</div>
        <h3>Admin KullanÄ±cÄ± SayÄ±sÄ±</h3>
      </div>
      <div class="vd-card-body">
        <div class="vd-kpi-value">
          {{ total_users }}
        </div>
        <div class="vd-kpi-caption">Sistemde tanÄ±mlÄ± yÃ¶netici / kullanÄ±cÄ± sayÄ±sÄ±.</div>
      </div>
    </div>
  </div>
</div>

<!-- Son YÃ¼klemeler -->
<div class="vd-section">
  <h2 class="vd-section-title">Son YÃ¼klemeler</h2>
  <div class="vd-card">
    <div class="vd-card-body">
      {% if not last_uploads %}
        <p>HenÃ¼z hiÃ§bir veri yÃ¼klemesi yapÄ±lmamÄ±ÅŸ.</p>
      {% else %}
        <div class="vd-table-wrapper">
          <table class="vd-table">
            <thead>
              <tr>
                <th>Tarih</th>
                <th>Firma</th>
                <th>Ad Soyad</th>
                <th>SektÃ¶r</th>
                <th>E-posta</th>
                <th>Telefon</th>
                <th>Dosya</th>
                <th>SatÄ±r / Kolon</th>
                <th>Kalite Skoru</th>
                <th>Rapor</th>
              </tr>
            </thead>
            <tbody>
              {% for u in last_uploads %}
                <tr>
                  <td>{{ u.created_at.strftime("%Y-%m-%d %H:%M") if u.created_at else "-" }}</td>
                  <td>{{ u.company or "-" }}</td>
                  <td>{{ u.contact_name or "-" }}</td>
                  <td>{{ u.contact_sector or "-" }}</td>
                  <td>
                    {% if u.contact_email %}
                      <a href="mailto:{{ u.contact_email }}" class="vd-link">{{ u.contact_email }}</a>
                    {% else %}
                      -
                    {% endif %}
                  </td>
                  <td>
                    {% if u.contact_phone %}
                      <a href="tel:{{ u.contact_phone }}" class="vd-link">{{ u.contact_phone }}</a>
                    {% else %}
                      -
                    {% endif %}
                  </td>
                  <td>{{ u.file_name }}</td>
                  <td>{{ u.row_count }} / {{ u.col_count }}</td>
                  <td>{{ (u.quality_score or 0)|round(1) }}%</td>
                  <td>
                    <a href="/download_pdf/{{ u.id }}" class="vd-btn vd-btn-ghost vd-btn-xs" target="_blank">
                      ğŸ“„ PDF
                    </a>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}
